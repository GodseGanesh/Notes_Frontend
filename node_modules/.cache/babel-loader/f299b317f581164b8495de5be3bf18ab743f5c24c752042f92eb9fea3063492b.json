{"ast":null,"code":"import React from\"react\";import{useEffect,useState}from\"react\";import{ReactComponent as ArrowLeft}from\"../assets/arrow-left.svg\";import{useParams,useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Notepage(history){const getCsrfToken=()=>{return document.cookie.split(\";\").map(cookie=>cookie.trim()).filter(cookie=>cookie.startsWith(\"csrftoken=\")).map(cookie=>decodeURIComponent(cookie.split(\"=\")[1])).join(\"\");};const csrfToken=getCsrfToken();const{noteId}=useParams();const navigate=useNavigate();let[note,setNote]=useState(null);const[notes,setNotes]=useState([]);useEffect(()=>{getNote();},[noteId]);let getNote=async()=>{if(noteId===\"new\")return;let response=await fetch(\"/api/note/\".concat(noteId));let data=await response.json();setNote(data);};let updateNote=async()=>{fetch(\"/api/note/\".concat(noteId,\"/update\"),{method:\"PUT\",headers:{\"Content-Type\":\"application/json\",\"X-CSRFToken\":csrfToken},body:JSON.stringify(note)});};let handleSubmit=()=>{if(noteId===\"new\"&&note===null){navigate(\"/\");return;}if(noteId!==\"new\"&&note.body===\"\"){deleteNote();}else if(noteId!==\"new\"){updateNote();}else if(noteId===\"new\"&&note.body!==null){createNote();}setNotes(prevNotes=>[...prevNotes,data]);navigate(\"/\");};let deleteNote=()=>{fetch(\"/api/note/\".concat(noteId,\"/delete\"),{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\",\"X-CSRFToken\":csrfToken}});navigate(\"/\");};let createNote=async()=>{fetch(\"/api/note/create\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",\"X-CSRFToken\":csrfToken},body:JSON.stringify(note)});};let handleChange=value=>{setNote(note=>({...note,body:value}));};return/*#__PURE__*/_jsxs(\"div\",{className:\"note\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"note-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:/*#__PURE__*/_jsx(ArrowLeft,{onClick:handleSubmit})}),noteId!==\"new\"?/*#__PURE__*/_jsx(\"button\",{onClick:deleteNote,children:\"Delete\"}):/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,children:\"Done\"})]}),/*#__PURE__*/_jsx(\"textarea\",{onChange:e=>{handleChange(e.target.value);},value:note===null||note===void 0?void 0:note.body})]});}export default Notepage;","map":{"version":3,"names":["React","useEffect","useState","ReactComponent","ArrowLeft","useParams","useNavigate","jsx","_jsx","jsxs","_jsxs","Notepage","history","getCsrfToken","document","cookie","split","map","trim","filter","startsWith","decodeURIComponent","join","csrfToken","noteId","navigate","note","setNote","notes","setNotes","getNote","response","fetch","concat","data","json","updateNote","method","headers","body","JSON","stringify","handleSubmit","deleteNote","createNote","prevNotes","handleChange","value","className","children","onClick","onChange","e","target"],"sources":["E:/Django_Projects/mynotes/mynotes_frontend/src/pages/Notepage.js"],"sourcesContent":["import React from \"react\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ReactComponent as ArrowLeft } from \"../assets/arrow-left.svg\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\n\r\nfunction Notepage(history) {\r\n  const getCsrfToken = () => {\r\n    return document.cookie\r\n      .split(\";\")\r\n      .map((cookie) => cookie.trim())\r\n      .filter((cookie) => cookie.startsWith(\"csrftoken=\"))\r\n      .map((cookie) => decodeURIComponent(cookie.split(\"=\")[1]))\r\n      .join(\"\");\r\n  };\r\n\r\n  const csrfToken = getCsrfToken();\r\n\r\n\r\n\r\n\r\n\r\n  const { noteId } = useParams();\r\n\r\n  const navigate = useNavigate();\r\n\r\n  let [note, setNote] = useState(null);\r\n  \r\n  const [notes, setNotes] = useState([]);\r\n\r\n  useEffect(() => {\r\n    getNote();\r\n  }, [noteId]);\r\n\r\n  let getNote = async () => {\r\n    if (noteId === \"new\") return;\r\n\r\n    let response = await fetch(`/api/note/${noteId}`);\r\n\r\n    let data = await response.json();\r\n\r\n    setNote(data);\r\n  };\r\n\r\n  let updateNote = async () => {\r\n    fetch(`/api/note/${noteId}/update`, {\r\n      method: \"PUT\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"X-CSRFToken\": csrfToken,\r\n      },\r\n      body: JSON.stringify(note),\r\n    });\r\n  };\r\n\r\n  let handleSubmit = () => {\r\n    if (noteId === \"new\" && note === null) {\r\n      navigate(\"/\");\r\n      return;\r\n    }\r\n\r\n    if (noteId !== \"new\" && note.body === \"\") {\r\n      deleteNote();\r\n    } else if (noteId !== \"new\") {\r\n      updateNote();\r\n    } else if (noteId === \"new\" && note.body !== null) {\r\n      createNote();\r\n    }\r\n    setNotes(prevNotes => [...prevNotes, data]);\r\n\r\n    navigate(\"/\");\r\n  };\r\n\r\n  let deleteNote = () => {\r\n    fetch(`/api/note/${noteId}/delete`, {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"X-CSRFToken\": csrfToken,\r\n        \r\n      },\r\n    });\r\n    navigate(\"/\");\r\n  };\r\n\r\n  let createNote = async () => {\r\n    fetch(`/api/note/create`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        \"X-CSRFToken\": csrfToken,\r\n      },\r\n      body: JSON.stringify(note),\r\n    });\r\n  };\r\n\r\n  let handleChange = (value) => {\r\n    setNote((note) => ({ ...note, body: value }));\r\n  };\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"note\">\r\n      <div className=\"note-header\">\r\n        <h3>\r\n          <ArrowLeft onClick={handleSubmit} />\r\n        </h3>\r\n        {noteId !== \"new\" ? (\r\n          <button onClick={deleteNote}>Delete</button>\r\n        ) : (\r\n          <button onClick={handleSubmit}>Done</button>\r\n        )}\r\n      </div>\r\n      <textarea\r\n        onChange={(e) => {\r\n          handleChange(e.target.value);\r\n        }}\r\n        value={note?.body}\r\n      ></textarea>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Notepage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}